# Сервис для размещения объявлени "AdHub"

---

## Стек технологий

- FastApi
- SQLAlchemy
- alembic
- python3.9
- postgresql@15

---

## Запуск проекта

В качестве примера, будет показан запуск проекта на операционной
системе `macOs`.

### Клонирование репозитория

Клонируем репозиторий:

`git clone git@github.com:DanilVolodchenko/InlyItTest.git`

### Создание виртуального окружения

Виртуальное окружение создается командой:
`python3.9 -m venv env`

Активируем его: `. env/bin/activate`

### Установка зависимостей

Все зависимости находятся в файле `requirements.txt`, для
их установки прописываем команду: `pip install -r requirements.txt`

### База данных

Проект работает на базе данных PostgreSQL@13. Устанавливаем
его `brew install postgresql@15`, затем поднимает базу
`brew services start postgresql@15`, скачиваем pdAdmin для
работы с базой данных `brew install pgadmin4`. Заходим в
pgAdmin и создаем подключение серверу, как это сделать можно
посмотреть [тут](https://fkn.ktu10.com/?q=node/9446).

Создаем таблицы в БД: `alembic upgrade head`

### Переменные окружения

В корне проекта AdHub нужно создать файл .env, в нем будут
находиться наши переменные. Чтобы увидеть переменные, которые
должны быть в файле .env, то нужно открыть файл .env.example:

```
DB_HOST=Хост БД
DB_PORT=Порт БД
DB_NAME=Имя БД
DB_USER=Имя юзера БД
DB_PASSWORD=Пароль БД

SECRET_KEY=Ключ для шифрования 
ALGORITHM=Алгоритм шифрования
ACCESS_TOKEN_EXPIRE_MINUTES=Количество минут существования 
токена

LOCAL_SERVER_HOST=Хост локального сервера
LOCAL_SERVER_PORT=Порт локального сервера
```

### Запуск проекта

В корне проекта набираем команду `python3 run.py`

## Docker

В проекте есть файл `Dockerfile`, где написан код сборки
docker-образа. Сборка осуществляется командой:
`docker build -t inlyit .`. После этого нужно запустить докер
базы данных, соединить их в сеть, чтобы они могли общаться
друг с другом и создать `volumes`, чтобы не потерять данные БД.

После успешной сборки образа, можно запустить контейнер:
`docker run --name adhub-container inlyit`. Теперь проект
запущен в docker-контейнере.

## Docker compose

Для того, чтобы запустить контейнеры одной командой можно 
применить `docker compose`, для этого из корневой директории
проекта прописываем `docker compose up`.